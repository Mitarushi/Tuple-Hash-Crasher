# Tuple-Hash-Crasher
このライブラリはPythonでhashが衝突するtupleを生成することを目的としています。
例えば、tupleを要素とするdictを使ったコードをTLEに出来るかもしれません。

# 使い方
### ビルド
```
cargo build --release
```
./target/release 下に実行ファイルが生成されます。(たぶん)

### 引数
```
USAGE:
    Tuple-Hash-Crasher.exe [OPTIONS] --length <length> --item_minimum <item_minimum> --item_maximum <item_maximum> --table_size <table_size>

OPTIONS:
    -f, --format                         出力をフォーマットするか
    -h, --hash <hash>                    出力するタプルのハッシュ値 (デフォルトでは 0 )
        --help                           ヘルプ
    -l, --length <length>                タプルの要素数
    -m, --item_minimum <item_minimum>    タプルの要素の最小値
    -M, --item_maximum <item_maximum>    タプルの要素の最大値 + 1
    -n, --number <number>                出力するタプルの数 (デフォルトでは 2^64 - 1)
    -o, --old                            Python3.7 以前の実装のハッシュを対象とするか
    -t, --table_size <table_size>        アルゴリズムの内部で使用するテーブルのサイズ (10^7 ~ 10^9ぐらい)
    -V, --version                        バージョン
```

Python3.8 でハッシュ関数の実装が変わったので、Python3.7 以前のプログラムを対象とする場合は --old フラグを付ける必要があります。( PyPy も競プロの文脈では 3.7 以前なことが現時点では多いです)

### 使用例
```
$ Tuple-Hash-Crasher.exe -f -l 5 -m 100000000 -M 110000000 -n 10 -o -t 100000000 -h 3141592
Tuple: 100423004 100000000 109453885 105396104 100000006,        Hash: 3141592
Tuple: 100423004 100000000 109453886 106593419 100000006,        Hash: 3141592
Tuple: 100423004 100000000 109453887 108283274 100000006,        Hash: 3141592
Tuple: 100423004 100000000 109453880 101026445 100000006,        Hash: 3141592
Tuple: 100423004 100000000 109453881 102224780 100000006,        Hash: 3141592
Tuple: 100423004 100000000 109453882 102832271 100000006,        Hash: 3141592
Tuple: 100423004 100000000 109453883 104030606 100000006,        Hash: 3141592
Tuple: 101100980 100000000 109404488 109366975 100000004,        Hash: 3141592
Tuple: 101100980 100000000 109404487 101154224 100000004,        Hash: 3141592
Tuple: 101100980 100000000 109404480 102139575 100000004,        Hash: 3141592
```

# 出力データ
すぐに使えるように以下の設定での出力データを用意しています。

| ファイル名     | タプルの数 | 要素数 | 最小値 | 最大値 | ハッシュ値          | バージョン | 
| -------------- | ---------- | ------ | ------ | ------ | ------------------- | ---------- | 
| 2_2e12.txt     | 200000     | 2      | 0      | 2e12   | 0                   | 3.8~       | 
| 2_2e12_old.txt | 200000     | 2      | 0      | 2e12   | 3713080549408328131 | ~3.7       | 
| 3_16e7.txt     | 200000     | 3      | 0      | 1.6e8  | 0                   | 3.8~       | 
| 3_16e7_old.txt | 200000     | 3      | 0      | 1.6e8  | 0                   | ~3.7       | 
| 4_15e5.txt     | 200000     | 4      | 0      | 1.5e6  | 0                   | 3.8~       | 
| 4_15e5_old.txt | 200000     | 4      | 0      | 1.5e6  | 0                   | ~3.7       | 
| 5_1e5.txt      | 200000     | 5      | 0      | 1e5    | 0                   | 3.8~       | 
| 5_1e5_old.txt  | 200000     | 5      | 0      | 1e5    | 0                   | ~3.7       | 

2_2e12_old.txt のハッシュ値のみ 0 ではない理由は下記注意参照。

# 注意
古い方のハッシュアルゴリズムではハッシュ値の分散が小さいので、特にタプルの要素数が少ないときは範囲内に条件を満たすタプルが見つかりにくいことがあります。

# 謝辞
熨斗袋 さん (@noshi91) にアルゴリズムの助言をいただきました。ありがとうございます。
